(this.webpackJsonpmappin=this.webpackJsonpmappin||[]).push([[0],{104:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(19),i=n.n(r),o=(n(75),n(76),n(23)),c=n(10),l=(n(77),n(13)),u=n(14),d=n(8),h=n(16),m=n(15),j=n(66),b=new(n(67).Dispatcher),p=new(function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this)).user=null,e}return Object(u.a)(n,[{key:"setUser",value:function(e){console.log("setting user to: "+(null===e||void 0===e?void 0:e.username)),this.user=e,this.emit("change")}},{key:"getUser",value:function(){return console.log("getting the user"),this.user}},{key:"handleActions",value:function(e){switch(e.type){case"SET_USER":this.setUser(e.user)}}}]),n}(j.EventEmitter));b.register(p.handleActions.bind(p));var g=p;function v(e){b.dispatch({type:"SET_USER",user:e})}var O,f=function e(){Object(l.a)(this,e),this.username="",this.pins=[]},x=n(2),w=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).clearUsername=a.clearUsername.bind(Object(d.a)(a)),a.state={username:""},a}return Object(u.a)(n,[{key:"clearUsername",value:function(){localStorage.removeItem("user"),this.setState({username:""});var e=new f;e.username="",v(e)}},{key:"componentDidMount",value:function(){var e=this;g.on("change",(function(){var t,n=null===(t=g.getUser())||void 0===t?void 0:t.username;void 0==n&&(n=""),e.setState({username:n})}))}},{key:"render",value:function(){return Object(x.jsxs)("nav",{className:"container topnav navbar navbar-dark bg-dark navbar-expand-lg",children:[Object(x.jsx)(o.b,{to:"/",className:"main_title navbar-brand",children:"MapPin"}),Object(x.jsxs)("div",{className:"collpase navbar-collapse",children:[""==this.state.username&&Object(x.jsxs)("ul",{className:"navbar-nav ml-auto",children:[Object(x.jsx)("li",{className:"navbar-item",children:Object(x.jsx)(o.b,{style:{color:"white"},to:"/contact",className:"nav-link",children:"Contact Us "})}),Object(x.jsx)("li",{className:"navbar-item",children:Object(x.jsx)(o.b,{style:{color:"white"},to:"/register",className:"nav-link",children:"Register"})}),Object(x.jsx)("li",{className:"navbar-item",children:Object(x.jsx)(o.b,{style:{color:"white"},to:"/login",className:"nav-link",children:"Log-In"})})]}),""!=this.state.username&&Object(x.jsxs)("ul",{className:"navbar-nav ml-auto",children:[Object(x.jsx)("li",{className:"navbar-item",children:Object(x.jsx)(o.b,{style:{color:"white"},to:"/contact",className:"nav-link",children:"Contact Us "})}),Object(x.jsx)("li",{className:"navbar-item",children:Object(x.jsxs)(o.b,{style:{color:"white"},to:"/login",className:"nav-link",onClick:this.clearUsername,children:[" Logout ",this.state.username]})})]})]})]})}}]),n}(s.a.Component),S=n(33),y=n(21),C=n.n(y),k=n(112),N=n(110),U=n(111),P=n(113),D=n(42),E=(n(102),n(28)),A=n.n(E),L=n(29),M=n.n(L);!function(e){e[e.ADD=0]="ADD",e[e.DELETE=1]="DELETE",e[e.UPDATE=2]="UPDATE"}(O||(O={}));var T=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).popover=function(e){return Object(x.jsxs)(k.a,{id:"popover-basic",children:[Object(x.jsx)(k.a.Title,{as:"h3",children:"Details"}),Object(x.jsxs)(k.a.Content,{children:["Latitude: ",e.lat.toFixed(4),Object(x.jsx)("br",{}),"Longitude: ",e.long.toFixed(4),Object(x.jsx)("br",{}),"Current User: ",localStorage.getItem("user"),Object(x.jsx)("br",{}),Object(x.jsxs)("span",{children:["Description: ",e.description]}),Object(x.jsx)("br",{}),Object(x.jsx)("button",{className:"btn btn-danger",onClick:a.handleUpdateShow,style:{marginTop:"10px",marginRight:"10px"},type:"button",children:"Update"}),Object(x.jsx)("button",{className:"btn btn-danger",onClick:a.handleDeleteShow,style:{marginTop:"10px",marginRight:"10px"},type:"button",children:"Delete"})]})]})},a.updateViewport=function(e){a.setState((function(t){return{viewport:Object(S.a)(Object(S.a)({},t.viewport),e)}}))},a.resize=function(){a.setState((function(e){return{viewport:Object(S.a)(Object(S.a)({},e.viewport),{},{height:window.innerHeight,width:window.innerWidth})}}))},a.convertMarkers=function(){var e=a.state.markers.slice();a.state.pins.forEach((function(t){return e.push(Object(x.jsx)(N.a,{rootClose:!0,trigger:"click",placement:"bottom",overlay:a.popover(t),children:Object(x.jsx)(D.a,{latitude:t.lat,longitude:t.long,offsetLeft:-20,offsetTop:-10,children:Object(x.jsx)("img",{onClick:function(){return a.setState({currentPin:t})},className:"imageHover",src:"/assets/pin.jpg",alt:"Here",style:{width:35,height:35}})})}))})),a.setState({markers:e})},a.removeMarkers=function(){var e=[];a.state.pins.forEach((function(t){return e.push(Object(x.jsx)(N.a,{rootClose:!0,trigger:"click",placement:"bottom",overlay:a.popover(t),children:Object(x.jsx)(D.a,{latitude:t.lat,longitude:t.long,offsetLeft:-20,offsetTop:-10,children:Object(x.jsx)("img",{onClick:function(){return a.setState({currentPin:t})},className:"imageHover",src:"/assets/pin.jpg",alt:"Here",style:{width:35,height:35}})})}))})),a.setState({markers:e})},a.addPin=function(e){var t=a.state.pins.slice(),n={name:"lng".concat(e.lngLat[0]),lat:e.lngLat[1],long:e.lngLat[0],description:"Edit me!"};t.push(n),C.a.post("/users/update/username/"+localStorage.getItem("user"),{username:localStorage.getItem("user"),pins:t}),a.setState({pins:t}),a.convertMarkers()},a.deleteMarker=function(e){a.setState((function(t){return{markers:t.markers.filter((function(t){return t.props.children.props.longitude!==e[0]&&t.props.children.props.latitude!==e[1]}))}}))},a.setPinActionAdd=a.setPinActionAdd.bind(Object(d.a)(a)),a.setPinActionDelete=a.setPinActionDelete.bind(Object(d.a)(a)),a.setPinActionUpdate=a.setPinActionUpdate.bind(Object(d.a)(a)),a.mapClickHandler=a.mapClickHandler.bind(Object(d.a)(a)),a.handleUpdateShow=a.handleUpdateShow.bind(Object(d.a)(a)),a.handleUpdateClose=a.handleUpdateClose.bind(Object(d.a)(a)),a.handleDeleteShow=a.handleDeleteShow.bind(Object(d.a)(a)),a.handleDeleteClose=a.handleDeleteClose.bind(Object(d.a)(a)),a.onNewDescriptionChange=a.onNewDescriptionChange.bind(Object(d.a)(a)),a.updatePin=a.updatePin.bind(Object(d.a)(a)),a.deletePin=a.deletePin.bind(Object(d.a)(a)),a.state={pinAction:O.ADD,viewport:{height:400,latitude:39.4018552,longitude:-76.602388,width:400,zoom:14},pins:[],markers:[],showUpdateModal:!1,showDeleteModal:!1,newDescription:"",currentPin:null},a}return Object(u.a)(n,[{key:"handleUpdateShow",value:function(){this.setState({showUpdateModal:!0})}},{key:"handleUpdateClose",value:function(){this.setState({showUpdateModal:!1})}},{key:"handleDeleteShow",value:function(){this.setState({showDeleteModal:!0})}},{key:"handleDeleteClose",value:function(){this.setState({showDeleteModal:!1})}},{key:"onNewDescriptionChange",value:function(e){this.setState({newDescription:e})}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.resize),this.resize(),C.a.get("/users/username/"+localStorage.getItem("user")).then((function(t){console.log(t.data),e.setState({pins:t.data.pins}),e.convertMarkers()}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"updatePin",value:function(){var e=this;if(void 0!=this.state.currentPin){var t={description:this.state.newDescription,lat:this.state.currentPin.lat,long:this.state.currentPin.long,name:"temporary"},n=this.state.pins.filter((function(e){return e.lat!==t.lat&&e.long!==t.long}));n.push(t);var a=M()(A.a);C.a.post("/users/update/username/"+localStorage.getItem("user"),{username:localStorage.getItem("user"),pins:n}).then((function(s){return e.setState({pins:n}),e.convertMarkers(),e.handleUpdateClose(),e.setState({currentPin:null,newDescription:""}),a.fire(Object(x.jsx)("p",{children:"Pin Updated!"}),Object(x.jsxs)("span",{children:[Object(x.jsx)("div",{children:"Your pin description has been updated to:"}),Object(x.jsx)("b",{children:t.description})]}),"success")}))}}},{key:"deletePin",value:function(){var e=this;if(void 0!=this.state.currentPin){var t={description:this.state.currentPin.description,lat:this.state.currentPin.lat,long:this.state.currentPin.long,name:"temporary"};console.log("CURRENT PINS:"),console.log(this.state.pins);var n=this.state.pins.filter((function(e){return e.lat!==t.lat&&e.long!==t.long})),a=M()(A.a);C.a.post("/users/update/username/"+localStorage.getItem("user"),{username:localStorage.getItem("user"),pins:n}).then((function(t){return e.setState({pins:n}),e.handleDeleteClose(),e.setState({currentPin:null,newDescription:""}),console.log("New PINS:"),console.log(e.state.pins),e.removeMarkers(),a.fire(Object(x.jsx)("p",{children:"Pin Deleted!"}),Object(x.jsx)("span",{children:Object(x.jsx)("div",{children:"Your pin has successfully been deleted!"})}),"success")}))}}},{key:"setPinActionAdd",value:function(){this.setState({pinAction:O.ADD})}},{key:"setPinActionDelete",value:function(){this.setState({pinAction:O.DELETE})}},{key:"setPinActionUpdate",value:function(){this.setState({pinAction:O.UPDATE})}},{key:"mapClickHandler",value:function(e){if(this.state.pinAction===O.ADD&&this.addPin(e),this.state.pinAction===O.DELETE){var t=[e.lngLat[0],e.lngLat[1]];this.deleteMarker(t),alert("Send to delete method")}this.state.pinAction===O.UPDATE&&alert("Send to update method")}},{key:"render",value:function(){var e,t=this,n=this.state.viewport;return Object(x.jsxs)("span",{children:[Object(x.jsxs)(D.c,Object(S.a)(Object(S.a)({},n),{},{className:"map-size",mapboxApiAccessToken:"pk.eyJ1IjoiYXR1dHRsZSIsImEiOiJja2x1bTdjOWIwMGwwMnhvMGdyN25jZ3I2In0.w195Lbtc6bu0CESgOWeAGw",onViewportChange:function(e){return t.updateViewport(e)},onClick:function(e){return t.mapClickHandler(e)},children:[this.state.markers,Object(x.jsx)("div",{children:Object(x.jsx)(D.b,{onViewportChange:this.updateViewport})})]})),Object(x.jsxs)(U.a,{show:this.state.showUpdateModal,onHide:this.handleUpdateClose,children:[Object(x.jsx)(U.a.Header,{closeButton:!0,children:Object(x.jsx)(U.a.Title,{children:"Update Pin Information"})}),Object(x.jsxs)(U.a.Body,{children:[Object(x.jsx)("div",{children:"Update the description of your pin:"}),Object(x.jsx)("input",{type:"text",placeholder:null===(e=this.state.currentPin)||void 0===e?void 0:e.description,value:this.state.newDescription,onChange:function(e){return t.onNewDescriptionChange(e.target.value)}})]}),Object(x.jsxs)(U.a.Footer,{children:[Object(x.jsx)(P.a,{variant:"secondary",onClick:this.handleUpdateClose,children:"Close"}),Object(x.jsx)(P.a,{variant:"primary",onClick:this.updatePin,children:"Save Changes"})]})]}),Object(x.jsxs)(U.a,{show:this.state.showDeleteModal,onHide:this.handleDeleteClose,children:[Object(x.jsx)(U.a.Header,{closeButton:!0,children:Object(x.jsx)(U.a.Title,{children:"Delete Pin"})}),Object(x.jsx)(U.a.Body,{children:Object(x.jsx)("b",{children:"Are you sure you want to delete this pin?"})}),Object(x.jsxs)(U.a.Footer,{children:[Object(x.jsx)(P.a,{variant:"secondary",onClick:this.handleDeleteClose,children:"Close"}),Object(x.jsx)(P.a,{variant:"danger",onClick:this.deletePin,children:"Delete"})]})]})]})}}]),n}(a.Component),I=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a,s;return Object(l.a)(this,n),(s=t.call(this,e)).state={username:null===(a=g.getUser())||void 0===a?void 0:a.username},s}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;g.on("change",(function(){var t,n=null===(t=g.getUser())||void 0===t?void 0:t.username;void 0==n?(console.log("home name is undefined - in if"),e.setState({username:""})):(console.log("home set the state"),e.setState({username:n}),console.log("home state: "+e.state.username))}))}},{key:"getUserFromLocalStorage",value:function(e){console.log("getting user from local storage"),C.a.get("".concat("","/users/username/").concat(e)).then((function(e){console.log("result from getting user from local storage: "+e.data),v(e.data),console.log(g.getUser)})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){if(""!=this.state.username&&void 0!=this.state.username&&null!=this.state.username||null!=localStorage.getItem("user")){var e=localStorage.getItem("user");return null!=e&&null==g.getUser()&&this.getUserFromLocalStorage(e),Object(x.jsx)("div",{id:"mapbox",className:"text-center",children:Object(x.jsx)(T,{})})}return Object(x.jsx)(c.a,{push:!0,to:"/register"})}}]),n}(s.a.Component),F=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onChangeUsername=a.onChangeUsername.bind(Object(d.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(d.a)(a)),a.onSubmit=a.onSubmit.bind(Object(d.a)(a)),a.state={username:"",password:"",redirect:!1,usernameError:""},a}return Object(u.a)(n,[{key:"onChangeUsername",value:function(e){var t=e.target;this.setState({username:t.value})}},{key:"onChangePassword",value:function(e){var t=e.target;this.setState({password:t.value})}},{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),this.setState({usernameError:""});var n=M()(A.a),a={username:this.state.username,password:this.state.password};try{C.a.post("/users/add",a).then((function(e){if(console.log(e.data),""!==e.data.error){if(!e.data.error.includes("username is taken"))return n.fire(Object(x.jsx)("p",{children:"Login Failed"}),Object(x.jsx)("span",{children:e.data.error}),"error");t.setState({usernameError:e.data.error})}else{if(null===e.data.user)return n.fire(Object(x.jsx)("p",{children:"Registration Failed"}),Object(x.jsx)("span",{children:"unexpected error occured"}),"error");v(e.data.user),localStorage.setItem("user",e.data.user.username),t.setState({redirect:!0})}})).catch((function(e){return console.log(e)}))}catch(s){console.log(s)}}},{key:"render",value:function(){return Object(x.jsxs)("div",{className:"container",style:{marginLeft:"auto",marginRight:"auto",width:"30%"},children:[this.state.redirect?Object(x.jsx)(c.a,{push:!0,to:"/"}):null,Object(x.jsx)("h3",{children:"Create Account"}),Object(x.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Username: "}),Object(x.jsx)("input",{type:"text",style:{width:"90%"},required:!0,className:"form-control",value:this.state.username,onChange:this.onChangeUsername}),this.state.usernameError.length>0&&Object(x.jsx)("div",{style:{color:"red",fontWeight:"bold",paddingBottom:"10px"},children:this.state.usernameError}),Object(x.jsx)("label",{children:"Password: "}),Object(x.jsx)("input",{type:"password",style:{width:"90%"},required:!0,className:"form-control",value:this.state.password,onChange:this.onChangePassword})]}),Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)("input",{type:"submit",value:"Register",className:"btn btn-primary"})})]})]})}}]),n}(s.a.Component),H=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onChangeUsername=a.onChangeUsername.bind(Object(d.a)(a)),a.onChangePassword=a.onChangePassword.bind(Object(d.a)(a)),a.onSubmit=a.onSubmit.bind(Object(d.a)(a)),a.state={username:"",password:"",users:[],redirect:!1,wrongUsername:"",wrongPassword:""},a}return Object(u.a)(n,[{key:"onChangeUsername",value:function(e){var t=e.target;this.setState({username:t.value})}},{key:"onChangePassword",value:function(e){var t=e.target;this.setState({password:t.value})}},{key:"onSubmit",value:function(e){var t=this;e.preventDefault(),this.setState({wrongPassword:"",wrongUsername:""});var n={username:this.state.username,password:this.state.password};C.a.post("/users/login",n).then((function(e){if(console.log(e),""!==e.data.error)e.data.error.includes("Username")&&t.setState({wrongUsername:e.data.error}),e.data.error.includes("Password")&&t.setState({wrongPassword:e.data.error});else{var n;if(null===e.data.user)return M()(A.a).fire(Object(x.jsx)("p",{children:"Login Failed"}),Object(x.jsx)("span",{children:"User was not found"}),"error");v(e.data.user),localStorage.setItem("user",null===(n=e.data.user)||void 0===n?void 0:n.username),t.setState({redirect:!0})}})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){return Object(x.jsxs)("div",{className:"container",style:{marginLeft:"auto",marginRight:"auto",width:"30%"},children:[this.state.redirect?Object(x.jsx)(c.a,{to:{pathname:"/"}}):null,Object(x.jsx)("h3",{children:"Sign in to Your Account"}),Object(x.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{children:"Username: "}),Object(x.jsx)("input",{type:"text",style:{width:"90%"},required:!0,className:"form-control",value:this.state.username,onChange:this.onChangeUsername}),this.state.wrongUsername.length>0&&Object(x.jsx)("div",{style:{color:"red",fontWeight:"bold",paddingBottom:"10px"},children:this.state.wrongUsername}),Object(x.jsx)("label",{children:"Password: "}),Object(x.jsx)("input",{type:"password",style:{width:"90%"},required:!0,className:"form-control",value:this.state.password,onChange:this.onChangePassword}),this.state.wrongPassword.length>0&&Object(x.jsx)("div",{style:{color:"red",fontWeight:"bold",paddingBottom:"10px"},children:this.state.wrongPassword})]}),Object(x.jsx)("div",{className:"form-group",children:Object(x.jsx)("input",{type:"submit",value:"Login",className:"btn btn-primary"})})]})]})}}]),n}(s.a.Component),R=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).onChangeFirstName=a.onChangeFirstName.bind(Object(d.a)(a)),a.onChangeLastName=a.onChangeLastName.bind(Object(d.a)(a)),a.onChangeEmail=a.onChangeEmail.bind(Object(d.a)(a)),a.onChangeMessage=a.onChangeMessage.bind(Object(d.a)(a)),a.onSubmit=a.onSubmit.bind(Object(d.a)(a)),a.state={firstName:"",lastName:"",email:"",message:"",status:"Submit"},a}return Object(u.a)(n,[{key:"onChangeFirstName",value:function(e){var t=e.target;this.setState({firstName:t.value})}},{key:"onChangeLastName",value:function(e){var t=e.target;this.setState({lastName:t.value})}},{key:"onChangeEmail",value:function(e){var t=e.target;this.setState({email:t.value})}},{key:"onChangeMessage",value:function(e){var t=e.target;this.setState({message:t.value})}},{key:"onSubmit",value:function(e){var t=this;e.preventDefault();var n=M()(A.a);this.setState({status:"Sending"}),C()({method:"POST",url:"/users/contact",data:this.state}).then((function(e){return"sent"===e.data.status?(t.setState({firstName:"",lastName:"",email:"",message:"",status:"Submit"}),n.fire(Object(x.jsx)("p",{children:"Message Sent!"}),Object(x.jsx)("span",{children:"Thank you for your email, we look forward to hearing from you!"}),"success")):"failed"===e.data.status?n.fire(Object(x.jsx)("p",{children:"Message Failed!"}),Object(x.jsx)("span",{children:"Uh oh! Something went wrong and we did not recieve your message"}),"error"):void 0}))}},{key:"render",value:function(){var e=this.state.status;return Object(x.jsxs)("div",{className:"container",children:[Object(x.jsxs)("div",{className:"title",children:[Object(x.jsx)("h1",{className:"page_title",children:"Contact the\xa0"}),Object(x.jsx)("h1",{className:"main_title",children:"Map-Pin"}),Object(x.jsx)("h1",{className:"page_title",children:"\xa0Team"})]}),Object(x.jsx)("div",{style:{marginTop:"18px"},children:Object(x.jsx)("div",{className:"inner_navcontainer",children:Object(x.jsx)("div",{className:"inner_contactcontainer",children:Object(x.jsxs)("form",{onSubmit:this.onSubmit,children:[Object(x.jsx)("label",{htmlFor:"fname",children:"First Name"}),Object(x.jsx)("input",{type:"text",id:"fname",name:"firstname",placeholder:"Your first name...",required:!0,className:"form-control",value:this.state.firstName,onChange:this.onChangeFirstName}),Object(x.jsx)("label",{htmlFor:"lname",children:"Last Name"}),Object(x.jsx)("input",{type:"text",id:"lname",name:"lastname",placeholder:"Your last name...",required:!0,className:"form-control",value:this.state.lastName,onChange:this.onChangeLastName}),Object(x.jsx)("label",{htmlFor:"email",children:"E-mail"}),Object(x.jsx)("input",{type:"email",id:"email",name:"email",placeholder:"Your e-mail...",required:!0,className:"form-control",value:this.state.email,onChange:this.onChangeEmail}),Object(x.jsx)("label",{htmlFor:"message",children:"What do you need to share?"}),Object(x.jsx)("textarea",{id:"message",name:"message",placeholder:"Write your message here...",required:!0,className:"form-control",value:this.state.message,onChange:this.onChangeMessage}),Object(x.jsx)("button",{type:"submit",style:{marginTop:"20px"},children:e})]})})})})]})}}]),n}(s.a.Component);var W=function(){return Object(x.jsxs)(o.a,{children:[Object(x.jsx)(w,{}),Object(x.jsx)("br",{}),Object(x.jsx)(c.b,{path:"/",exact:!0,component:I}),Object(x.jsx)(c.b,{path:"/register",exact:!0,component:F}),Object(x.jsx)(c.b,{path:"/login",exact:!0,component:H}),Object(x.jsx)(c.b,{path:"/contact",exact:!0,component:R})]})};i.a.render(Object(x.jsx)(W,{}),document.getElementById("root"))},75:function(e,t,n){},77:function(e,t,n){}},[[104,1,2]]]);
//# sourceMappingURL=main.4eae70da.chunk.js.map